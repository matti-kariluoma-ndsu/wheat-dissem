{% extends "w12_frame.html" %}
{% load django_math %}
{% block content %}
<div class="tabs years">
{% for yearname in years %}
<div style="display:none">
	<form name="{{yearname}}form" action="/view/location/{{yearname}}/{{curfield}}/2" method="post">
		{% csrf_token %}
		{% for field in locations_form %}
		<div class="input row">
			{{ field.errors }}
			{{ field.label_tag }}: {{ field }}
		</div>
		{% endfor %}
		{% for field in varieties_form %}
		<div class="input row">
			{{ field.errors }}
			{{ field.label_tag }}: {{ field }}
		</div>
		{% endfor %}
		<input type="submit" value="{{yearname}} submit" />
	</form>
</div>
{% endfor %}
</div>

<div class="tabs units">
{% for fieldname, blurb_list in blurbs.items %}
	<div class="{{fieldname}}" style="display:none">
		<form name="{{fieldname}}form" action="/view/location/{{curyear}}/{{fieldname}}/2" method="post">
			{% csrf_token %}
			{% for field in locations_form %}
			<div class="input row">
				{{ field.errors }}
				{{ field.label_tag }}: {{ field }}
			</div>
			{% endfor %}
			<input type="submit" value="{{fieldname}} submit" />
		</form>
	</div>
{% endfor %}
</div>

<table border="0" style="width: 100%; border-collapse:collapse; background-color:#FFC; background-image:url('/static/img/curve2.png'); background-repeat: no-repeat; background-size: 100%">
  <tbody>

    <tr>
      <td colspan="6" style="height: 2em" ></td>
    </tr>
    <tr style="text-align: center; font-weight: bold;">
		<div>
			{% for fieldname, blurb_list in blurbs.items %}
		<div > <!-- style="padding: 5px;" TODO: Apply on NoScript?-->
		{% if fieldname == curfield %}
		<td style="background-color: #ffc; ">
			{{blurb_list.0}}
		</td>
		{% else %}
		<td>
			<a onclick="document['{{fieldname}}form'].submit(); return false" class="tab" href="/view/location/{{curyear}}/{{fieldname}}/2/">
			{{blurb_list.0}}
			</a>
		</td>
		{% endif %}
			
		
		</div>
		{% endfor %}
	</div>
    </tr>

		<div>
		{% for yearname in years %}
		{% if yearname == curyear %}
		<tr style="text-align: center; font-size: .75em; color: black;">
			{% for fieldname, blurb_list in blurbs.items %}
			{% if fieldname == curfield %}
      <td style="background-color: #ffc;">	
				{{yearname}}
      </td>
      {% else %}
      <td></td>
			{% endif %}
			{% endfor %}
		{% else %}
		<tr style="text-align: center; font-size: .75em; color: grey;">
			{% for fieldname, blurb_list in blurbs.items %}
			{% if fieldname == curfield %}
			<td style="background-color: #ffc;">
				<a onclick="document['{{yearname}}form'].submit(); return false" class="tab" href="/view/location/{{yearname}}/{{curfield}}/2/">
				{{yearname}}
				</a>
      </td>
      {% else %}
      <td></td>
			{% endif %}
			{% endfor %}
		{% endif %}
    </tr>
		{% endfor %}
	</div>
  </tbody>
</table>

<table border="0" style="width: 100%; background-color:#FFC;">
  <tbody>

    <tr>
      <td colspan="6">
				<div class="django_trial_results_content">
<table border="0" style="margin: 1em; background-color: #c6d055">
<tr>

	<td colspan="6" style="font-size: 1.5em; font-weight:bold; width: 20%; text-align:right; ">
				{% for fieldname, blurb_list in blurbs.items %}
				{% if fieldname == curfield %}
						{{blurb_list.0}} ({{curyear}})
				{% endif %}
				{% endfor %}
			</td>
</tr>
<tr>
<td>
	<div id="static_content">
		<table border='1'>
			<tr>
				<td colspan="{{ heading_list|length }}">
					{% for fieldname, blurb_list in blurbs.items %}
					{% if fieldname == curfield %}
							<p>{{blurb_list.0}}: {{blurb_list.1}}</p>
							<p>{{blurb_list.2}}</p>
					{% endif %}
					{% endfor %}
				</td>
			</tr>
			<tr>
				<td colspan="{{ heading_list|length }}" class="current_year"></td> <!--TODO: Hardcoded value `2' isn't always correct-->
			</tr>
			<tr >
				<td class="Variety padded"><h3> Variety</h3></td>
				{% for heading in heading_list %}
				<td class="{{ heading }} padded"><h3>{{ heading }}</h3></td>
				{% endfor %}
			</tr>
			<tr class="row subheadings thin">
			</tr>
		{% for datalist in sorted_list %}
			{% if datalist.0 != "LSD" %}
			<tr class="group {% cycle 'w12_odd' 'w12_even' %}">
				{% for element in datalist %}
				<td class='{{ element }} padded'>{{ element|default_if_none:"--" }}</td>
				{% endfor %}
			</tr>
			{% else %}
			<tr class="spacer_row">
				<td></td>
			</tr>
			<tr style="background-color: #FFC;">
				{% for element in datalist %}
				<td class='{{ element }} padded'>{{ element|default_if_none:"--" }}</td>
				{% endfor %}
			</tr>
			<tr class="spacer_row">
				<td></td>
			</tr>
			{% endif %}
		{% endfor %}
			<tr class="bottom_spacer"></tr>
	  </table>
	</div>
	<div class="clear">&#160;</div>
</td>
</tr>
</table>
	<!--
	<div id='dynamic_content'></div>
	-->
					</div>
      </td>
    </tr>
  </tbody>
</table>
{% endblock %}

{% load jsonify %}
{% block jquery %}

  $('.group .master').toggle(
    function(){
      $(this).siblings('.slave').show();
    },
    function(){
      $(this).siblings('.slave').hide();  
    }
  );

{% endblock %}
