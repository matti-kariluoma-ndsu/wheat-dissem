{% extends "base.html" %}
{% block content %}

<div id="main">
	<h2 style="margin-left: 2em;">NDSU Hard Red Spring Wheat Trial Results</h2>
	<hr>
	<h2>Welcome</h2><br/>
	<p>Presented here are the data collected during Hard Red Spring Wheat
	(HRSW) variety trials conducted in North Dakota and Minnesota. 
	Available data include yield, protein percent, test weight, 
	kernel weight, plant height, etc.</p>
</div>

<div>
	{% for error in error_list %}
	<p style='color: red'>{{ error }}</p>
	{% endfor %}
		<form id="static_form" action="/view/last_3_years/bushels_acre/" method="GET">
			{% for field in zipcode_form %}
			{% if field.name == 'zipcode' %}
			<div id='variety_trials__zipcode_input'>
			{% elif field.name == 'scope' %}
			<div id='variety_trials__scope_input'>
			{% else %}
			<div class="variety_trials__hidden_input" style="display: none;">
			{% endif %}
				{{ field.errors }}
				{{ field.label_tag }}: {{ field }}
			</div>
			{% endfor %}
			<input type="submit" value="Submit" />
		</form>
		<form id="dynamic_form" style="display: none;">
			Zipcode: <input id="js_zipcode" type="text" name="zipcode" autocomplete="off" onkeyup="variety_trials_app.initSuggest(); return false;"/><br />
			<div class="jsonSuggestResults" style="top: 494px; left: 8px; width: 410px;">
			</div>
			<input TYPE="submit" Value="Submit" onClick="variety_trials_app.makeTable(); return false;">
		</form>
</div>

<div id="dynamic_table" style="display: none;">
	<INPUT TYPE="button" NAME="button" Value="Swap Rows" onClick="variety_trials_app.reorderTable(1,4); return false;">
	<INPUT TYPE="button" NAME="button" Value="Output Data" onClick="variety_trials_app.testData(); return false;">
	<table>
		<thead><tr id=location><th></th></tr></thead>
		<tbody id="debug"></tbody>
	</table>
</div>

{% endblock %}

{% block javascript_imports %}
<script language="JavaScript" src="/static/js/jquery.jsonSuggest.js"></script>
<script language="JavaScript" src="/static/js/json2.min.js"></script>
<script language="JavaScript" src="/static/js/variety_trials_app.js"></script>
{% endblock %}

{% block javascript %}

function variety_trials__init()
{
	$('#dynamic_form').show();
	$('#dynamic_table').show();
	$('#static_form').hide();
	if (variety_trials_app)
	{
		variety_trials_app.initSuggest = function()
		{
			var input = $('input#js_zipcode')
			var get_url = "/autocomplete/zipcode/"+input.val()+"/json/"
			var entry1 = {
				url: get_url,
				dataType: "json",
			}
			
			function processAjaxFunction(zipcodes) 
			{
				testData = {}
				testData.city = []
				for (i=0; i < zipcodes.length; i++)
				{
					zipcode_object = zipcodes[i];
					//alert(JSON.stringify(zipcode_object));
					testData.city.push({
						text: String(zipcode_object.fields.zipcode),
						extra: zipcode_object.fields.city + ", " + zipcode_object.fields.state
						})
				}
				
				
				//testData.city=[{"text":"58102","extra":"Fargo,ND"}];
				input.jsonSuggest(testData.city, {maxResults:20});
			}
			
			jQuery.ajax(entry1).done(processAjaxFunction);
		}
	}
}

//variety_trials__init();

{% endblock %}

