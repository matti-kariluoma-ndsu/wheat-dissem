#$ python manage.py shell
from variety_trials_data import models

## source "17 WHIP.xlsx" sent 2017 Dec 7 12:22

locations = [
    "Saint Paul",
    "Waseca",
    "Lamberton",
    "Morris",
    "Crookston",
    "Roseau",
    "Fergus Falls",
    "Perley",
    "Oklee",
    "Stephen",
    "Hallock",
    "Benson",
    "Le Center",
    "Kimball",
    'Lamberton-i',
    'Morris-i',
    'Crookston-i',
    'Roseau-i'
  ]

rename_locations = {
    'Lamberton-i': ('Lamberton', 'intensive'),
    'Morris-i': ('Morris', 'intensive'),
    'Crookston-i': ('Crookston', 'intensive'),
    'Roseau-i': ('Roseau', 'intensive'),
  }

fail = False
for lname in locations:
  try:
    if lname in rename_locations:
      lname, tags = rename_locations[lname]
    location = models.Location.objects.filter(name=lname)[0]
  except:
    fail = True
    print 'Missing Location record: ', lname

varieties = [
    "Bolles",
    "Boost",
    "Chevelle",
    "Dyna-Gro Ambush",
    "Dyna-Gro Caliber",
    "Faller",
    "Forefront",
    "HRS 3361",
    "HRS 3419",
    "HRS 3504",
    "HRS 3530",
    "HRS 3616",
    "Lang-MN",
    "LCS Albany",
    "LCS Anchor",
    "LCS Breakaway",
    "LCS Iguacu",
    "LCS Nitro",
    "LCS Prime",
    "LCS Rebel",
    "Linkert",
    "ND-VitPro",
    "Prevail",
    "Prosper",
    "RB07",
    "Rollag",
    "Shelly",
    "Surpass",
    "SY Ingmar",
    "SY Rowyn",
    "SY Soren",
    "SY Valda",
    "TCG-Climax",
    "TCG-Cornerstone",
    "TCG-Spitfire",
    "WB-Mayville",
    "WB9479",
    "WB9590",
    "WB9653"
  ]

rename_varieties = {}
rename_varieties["Chevelle"] = "MS Chevelle"
rename_varieties["TCG-Cornerstone"] = "TCG Cornerstone"
rename_varieties["TCG-Spitfire"] = "TCG Spitfire"
rename_varieties["TCG-Climax"] = "TCG Climax"
rename_varieties["Dyna-Gro Ambush"] = "Ambush"
rename_varieties["Dyna-Gro Caliber"] = "Caliber"
rename_varieties["ND-VitPro"] = "ND VitPro"


for vname in varieties:
  try:
    if vname in rename_varieties:
      vname = rename_varieties[vname]
    variety = models.Variety.objects.filter(name=vname)[0]
  except:
    fail = True
    print 'Missing Variety record: ', vname
    models.Variety.objects.filter(name__contains=vname)

if fail:
  print ("ERROR: Missing records. See preceding output. Exiting...")
  import sys
  sys.exit(1)

# location name, yield lsd5
yield_lsds = [
    (   "Saint Paul", 10.75),
    (    "Waseca", 9.25),
    (    "Lamberton",9.42),
    (    "Morris",14.75),
    (    "Crookston",10.25),
    (    "Roseau",8.25),
    (    "Fergus Falls",6.75),
    (    "Perley",5.17),
    (    "Oklee",8.75),
    (    "Stephen",5.75),
    (    "Hallock",10.58),
    (    "Benson",12.5),
    (    "Le Center",9.5),
    (    "Kimball",11.17),
    (    'Lamberton-i',7.6),
    (    'Morris-i',9.9),
    (    'Crookston-i',11.5),
    (    'Roseau-i',9.8)
  ]

# regexps to help transform tab-delimited copy+paste from source workbook
# s/\t/, /
# s/$/]/
# s/^/yields["/
# s/^([^,]+), /\1"]=[/
yields = {}
#yields["Bolles"] = [ 103.5, 96.6, 101.3, 85.4, 70.7, 63.7, 73.0, 82.0, 81.8, 75.9, 82.9, 96.0, 62.6, 71.5, 67.2, 73.6]
yields["Bolles"] = [ 73.3, 106.5, 77.7, 87.4, 96.1, 73.6, 79.4, 60.1, 82.4, 117.1, 102.0, 72.8, 105.0, 90.4, 70.7, 64.5, 105.1, 115.3]
yields["Boost"] = [ 81.4, 117.4, 86.1, 95.1, 97.5, 75.1, 85.3, 54.9, 80.6, 111.5, 104.5, 66.3, 103.1, 93.8, 77.6, 64.3, 116.7, 111.1]

yields["Chevelle"] = [ 77.5, 115.8, 97.4, 101.6, 91.3, 93.7, 97.5, 66.7, 85.3, 126.0, 100.2, 68.8, 115.2, 101.1, 86.7, 73.5, 133.7, 111.4]

yields["Dyna-Gro Ambush"] = [ 99.2, 106.1, 84.9, 97.9, 92.8, 82.9, 90.4, 64.5, 82.8, 115.6, 93.1, 69.6, 104.1, 103.0, 81.1, 75.5, 100.0, 115.0]

yields["Dyna-Gro Caliber"] = [ 95.0, 108.3, 82.0, 89.8, 89.4, 73.2, 80.2, 51.7, 70.0, 100.7, 89.5, 73.2, 99.0, 73.8, 69.3, 57.0, 101.2, 98.1]

yields["Faller"] = [ 99.6, 126.1, 99.6, 108.4, 92.6, 92.6, 82.7, 58.0, 85.6, 129.1, 113.8, 78.1, 114.6, 82.1, 91.7, 76.7, 129.4, 129.1]

yields["Forefront"] = [ 103.3, 104.2, 73.8, 85.7, 96.2, 74.0, 88.2, 58.9, 81.1, 113.7, 101.2, 81.5, 103.3, 97.7, 78.7, 66.9, 97.2, 106.2]

yields["HRS 3361"] = [ 92.0, 118.1, 82.4, 90.7, 93.6, 82.5, 94.7, 60.7, 69.3, 112.7, 97.3, 75.7, 106.6, 97.8, 78.1, 66.5, 111.1, 112.1]

yields["HRS 3419"] = [ 111.5, 119.3, 95.4, 93.9, 93.9, 79.8, 100.3, 64.8, 96.4, 124.6, 119.2, 75.7, 118.0, 102.8, 82.8, 74.2, 129.9, 123.2]

yields["HRS 3504"] = [ 107.4, 125.0, 96.7, 105.3, 89.3, 91.0, 94.9, 69.4, 83.9, 121.0, 111.5, 76.0, 108.0, 108.9, 84.9, 73.5, 119.9, 124.1]

yields["HRS 3530"] = [ 100.5, 112.6, 94.6, 99.2, 94.9, 88.5, 103.9, 55.0, 74.5, 123.7, 108.8, 73.5, 124.7, 104.2,92.8, 68.9, 106.4, 121.8]

yields["HRS 3616"] = [ 74.1, 101.9, 89.1, 94.8, 97.3, 77.5, 87.9, 57.0, 76.9, 114.8, 98.8, 66.0, 103.2, 85.7, 79.8, 67.7, 108.2, 98.3]

yields["Lang-MN"] = [ 90.6, 101.7, 86.9, 99.9, 99.7, 85.6, 80.0, 66.0, 76.1, 103.8, 99.2, 76.7, 97.8, 97.2, 83.8, 74.4, 100.5, 113.6]

yields["LCS Albany"] = [ 97.5, 140.9, 96.8, 94.4, 102.1, 84.5, 91.4, 60.4, 91.6, 118.2, 113.4, 71.8, 112.4, 86.7, 89.9, 77.0, 124.7, 125.5]

yields["LCS Anchor"] = [ 82.9, 90.7, 80.0, 85.7, 91.3, 73.9, 91.9, 50.3, 72.5, 104.8, 72.7, 66.1, 97.8, 79.5, 73.6, 61.3, 93.3, 95.5]

yields["LCS Breakaway"] = [ 95.8, 89.6, 98.5, 93.2, 97.8, 82.3, 82.5, 61.0, 76.3, 118.0, 89.5, 70.2, 100.0, 100.2, 81.0, 72.7, 90.9, 104.4]

yields["LCS Iguacu"] = [ 93.8, 128.4, 83.5, 97.5, 94.1, 80.4, 95.7, 61.8, 90.6, 119.3, 108.4, 61.2, 114.0, 87.5, 75.0, 69.6, 120.9, 119.5]

yields["LCS Nitro"] = [ 96.7, 115.9, 86.9, 93.9, 93.6, 78.2, 95.6, 69.9, 76.4, 124.0, 106.7, 64.0, 109.7, 97.9,76.2, 79.4, 118.3, 116.8]

yields["LCS Prime"] = [ 107.7, 94.3, 103.7, 108.9, 93.2, 96.2, 98.7, 65.8, 90.8, 129.3, 108.6, 70.9, 108.4, 95.6, 92.6, 74.6, 107.8, 127.7]

yields["LCS Rebel"] = [87.7, 113.3, 87.7, 100.6, 89.7, 83.4, 82.4, 57.1, 82.5, 109.9, 99.9, 72.3, 105.6, 85.9, 82.5, 68.0, 113.9, 119.7]

yields["Linkert"] = [ 93.3, 102.8, 84.5, 96.7, 88.3, 83.6, 88.8, 59.4, 74.9, 110.8, 95.7, 77.6, 94.1, 92.0, 78.0, 68.4, 106.9, 102.1]

yields["ND-VitPro"] = [ 81.4, 98.1, 77.2, 91.7, 95.8, 74.2, 76.5, 49.3, 68.8, 106.7, 93.9, 73.0, 95.6, 90.5, 69.8, 61.3, 89.9, 104.4]

yields["Prevail"] = [ 98.6, 95.0, 88.6, 96.4, 100.5, 75.2, 90.4, 53.4, 79.9, 107.9, 99.7, 71.6, 101.8, 94.5, 78.1, 66.1, 93.0, 105.6]

yields["Prosper"] = [ 107.6, 121.1, 97.0, 109.5, 101.7, 91.8, 93.4, 54.7, 87.9, 124.7, 112.0, 77.8, 117.5, 89.6, 95.1, 72.8, 136.5, 129.2]

yields["RB07"] = [ 82.0, 109.4, 96.1, 96.4, 94.6, 75.4, 87.2, 56.3, 74.0, 116.0, 89.7, 65.0, 114.3, 92.9, 79.6, 53.9, 116.7, 107.7]

yields["Rollag"] = [ 92.7, 103.0, 86.5, 89.5, 92.3, 79.5, 90.0, 55.0, 76.1, 111.7, 88.1, 67.3, 104.4, 85.1, 77.2, 57.0, 100.9, 98.0]

yields["Shelly"] = [ 88.7, 118.0, 106.0, 97.6, 100.4, 90.9, 94.7, 65.3, 83.3, 124.8, 110.8, 78.1, 119.9, 98.3, 89.1, 76.8, 116.8, 121.7]

yields["Surpass"] = [102.3, 104.0, 92.3, 103.7, 101.9, 84.2, 80.3, 54.9, 78.5, 115.2, 101.5, 78.5, 108.6, 106.7, 77.2, 63.0, 108.7, 112.2]

yields["SY Ingmar"] = [90.5, 96.3, 87.0, 90.0, 84.9, 83.0, 93.5, 52.7, 82.4, 111.3, 89.9, 68.3, 103.5, 95.0, 84.8, 60.8, 91.4, 98.9]

yields["SY Rowyn"] = [ 102.7, 113.2, 97.1, 95.0, 90.4, 78.2, 86.9, 62.3, 88.9, 125.2, 104.3, 68.4, 111.4, 90.2, 79.9, 68.9, 116.4, 110.4]

yields["SY Soren"] = [ 81.8, 110.5, 87.5, 94.0, 103.9, 82.1, 94.1, 58.4, 76.5, 106.7, 98.0, 71.4, 104.3, 88.2,82.7, 57.7, 110.3, 106.1]

yields["SY Valda"] = [ 110.7, 126.3, 103.7, 104.8, 94.3, 95.0, 106.7, 64.0, 92.6, 125.1, 106.2, 74.0, 120.3, 105.7,96.3, 71.1, 122.1, 120.7]

yields["TCG-Climax"] = [85.5, 116.6, 86.5, 82.5, 90.3, 81.9, 72.9, 65.7, 85.8, 102.2, 97.1, 66.3, 101.1, 88.9, 78.8, 69.3, 121.2, 106.0]

yields["TCG-Cornerstone"] = [ 91.5, 94.6, 88.7, 84.6, 90.8, 84.8, 91.7, 60.6, 67.8, 107.0, 89.9, 72.1, 94.6, 86.3, 83.0, 63.7, 99.8, 99.2]

yields["TCG-Spitfire"] = [ 95.5, 111.5, 99.9, 93.3, 96.1, 97.1, 98.2, 65.5, 91.2, 118.0, 103.0, 80.0, 110.5, 95.7,93.8, 68.4, 98.7, 122.8]

yields["WB-Mayville"] = [113.0, 91.2, 87.8, 91.7, 102.5, 85.4, 94.6, 65.9, 73.1, 109.6, 91.8, 71.4, 106.3, 90.4,86.4, 66.6, 105.3, 102.8]

yields["WB9479"] = [ 103.9, 111.5, 83.2, 88.3, 96.8, 80.8, 82.9, 64.5, 81.4, 113.6, 96.1, 71.4, 112.0, 96.1, 61.3,80.5, 69.6, 113.9, 113.2]

yields["WB9590"] = [ 112.4, 109.3, 92.0, 95.8, 97.4, 80.9, 82.9, 68.1, 78.5, 118.8, 88.6, 69.6, 120.4, 101.4, 83.8, 74.8, 102.8, 125.0]


yields["WB9653"] = [ 104.4, 109.3, 97.0, 108.1, 92.2, 90.5, 98.5, 59.6, 81.0, 118.9, 113.5, 78.8, 108.1, 112.9, 84.9, 75.4, 110.0, 122.7]



proteins = {}
#proteins["Bolles"] = [ 14.8, 14.0, 15.4, 17.1, 16.7, 17.5, 16.9, 16.2, 17.2, 16.2, 16.0, 15.1, 17.0, 15.9, 14.2, 15.2]
proteins["Bolles"]=[14.0, 16.2, 16.2, 17.1, 13.2, 14.3, 14.8, 15.8, 16.3, 16.2, 11.6, 17.4, 16.0, 17.6, 17.7, 18.2, 13.9, 12.6]
proteins["Boost"]=[14.6, 15.8, 16.0, 16.7, 13.1, 13.5, 14.8, 13.9, 15.3, 14.6, 12.2, 15.3, 14.9, 16.6, 16.0, 15.8, 13.1, 11.9]
proteins["Chevelle"]=[11.9, 13.9, 14.5, 15.4, 12.2, 11.5, 13.0, 13.2, 13.8, 13.6, 10.3, 14.7, 13.6, 14.5, 14.4, 13.4, 12.6, 12.3]
proteins["Dyna-Gro Ambush"]=[13.0, 14.9, 16.0, 15.5, 14.4, 13.4, 14.6, 14.6, 15.0, 15.1, 12.2, 15.4, 14.5, 15.7, 15.7, 14.8, 13.9, 13.0]
proteins["Dyna-Gro Caliber"]=[14.5, 16.4, 14.5, 15.8, 14.6, 14.2, 15.0, 15.0, 15.4, 14.8, 13.6, 15.4, 15.2, 15.7, 16.3, 16.5, 14.1, 12.5]
proteins["Faller"]=[12.6, 13.1, 14.2, 13.7, 11.7, 11.9, 13.9, 13.0, 13.1, 13.9, 10.9, 15.0, 13.2, 14.8, 15.1, 13.9, 11.6, 10.5]
proteins["Forefront"]=[13.4, 15.7, 15.7, 16.6, 13.6, 13.9, 14.2, 14.0, 14.2, 14.9, 12.2, 14.9, 14.4, 14.8, 15.7, 15.4, 13.4, 12.1]
proteins["HRS 3361"]=[13.4, 15.3, 14.4, 15.6, 13.0, 13.1, 13.5, 13.7, 15.0, 14.4, 12.7, 15.3, 14.0, 15.4, 15.1, 13.8, 13.0, 12.7]
proteins["HRS 3419"]=[14.0, 13.5, 15.0, 14.2, 11.9, 11.6, 12.6, 12.9, 12.8, 14.3, 10.9, 14.3, 12.9, 15.5, 14.1, 13.1, 10.8, 10.4]
proteins["HRS 3504"]=[12.7, 14.4, 14.5, 15.2, 12.5, 12.8, 13.0, 13.5, 13.3, 14.0, 11.6, 14.5, 14.4, 15.6, 14.6, 14.6, 12.1, 11.4]
proteins["HRS 3530"]=[13.2, 14.8, 16.4, 16.5, 12.7, 12.2, 14.4, 13.9, 14.1, 14.6, 11.1, 15.6, 15.3, 15.4, 16.9, 15.9, 12.8, 11.1]
proteins["HRS 3616"]=[13.9, 16.2, 16.2, 17.0, 14.0, 14.4, 14.6, 14.7, 15.0, 15.2, 13.3, 15.8, 15.4, 16.0, 16.6, 17.1, 14.3, 13.0]
proteins["Lang-MN"]=[14.3, 15.6, 15.8, 15.7, 13.2, 13.6, 13.9, 14.8, 14.4, 15.4, 13.2, 15.2, 15.3, 15.6, 15.8, 16.0, 13.8, 12.2]
proteins["LCS Albany"]=[13.2, 13.8, 14.5, 15.4, 11.3, 11.7, 13.4, 12.9, 13.5, 13.6, 11.0, 13.9, 14.3, 14.9, 14.3, 14.2, 11.5, 10.8]
proteins["LCS Anchor"]=[14.9, 16.4, 15.9, 16.1, 14.0, 14.5, 14.1, 14.7, 15.6, 14.9, 12.9, 15.0, 14.7, 15.2, 16.4, 15.5, 13.2, 13.7]
proteins["LCS Breakaway"]=[13.2, 15.8, 15.9, None, 13.8, 13.5, 14.4, 14.3, 14.7, 14.5, 11.8, 14.5, 15.2, 15.7, 15.9, 15.8, 13.3, 12.6]
proteins["LCS Iguacu"]=[14.3, 13.6, 14.7, 14.2, 11.5, 11.3, 13.3, 12.5, 13.0, 12.7, 11.7, 13.4, 13.0, 14.0, 14.7, 14.4, 12.1, 11.4]
proteins["LCS Nitro"]=[13.2, 14.1, 14.3, 14.4, 12.1, 11.8, 12.9, 12.9, 13.2, 13.5, 10.8, 13.9, 13.3, 14.6, 14.6, 13.6, 12.5, 10.2]
proteins["LCS Prime"]=[12.2, 13.7, 14.2, 13.2, 12.6, 12.1, 13.2, 12.9, 13.3, 14.0, 11.4, 14.3, 13.1, 14.1, 14.3, 12.1, 12.3, 11.7]
proteins["LCS Rebel"]=[14.1, 15.4, 15.6, 15.1, 13.3, 13.3, 13.7, 14.2, 14.4, 14.9, 11.5, 15.5, 14.8, 14.9, 16.3, 15.9, 13.6, 11.6]
proteins["Linkert"]=[14.1, 15.8, 16.1, 16.6, 14.6, 15.0, 15.0, 15.2, 16.6, 15.6, 12.8, 15.8, 15.2, 16.6, 16.4, 16.0, 13.7, 13.6]
proteins["ND-VitPro"]=[13.6, 15.8, 15.8, 16.2, 14.2, 13.9, 14.3, 15.3, 15.8, 15.4, 13.4, 15.4, 15.9, 15.6, 15.0, 15.4, 13.7, 12.8]
proteins["Prevail"]=[12.6, 15.2, 15.4, 15.8, 13.2, 12.7, 13.6, 13.8, 14.7, 13.9, 12.2, 14.1, 14.2, 14.4, 15.4, 14.2, 13.5, 12.3]
proteins["Prosper"]=[12.9, 13.5, 14.7, 13.4, 12.0, 11.3, 13.8, 12.8, 13.1, 13.8, 11.5, 14.5, 12.8, 13.7, 15.0, 13.6, 12.3, 10.8]
proteins["RB07"]=[13.6, 16.3, 16.1, 14.8, 13.6, 13.5, 14.1, 13.9, 14.7, 14.4, 12.3, 15.8, 14.3, 15.3, 15.9, 14.5, 13.2, 12.1]
proteins["Rollag"]=[14.0, 16.5, 16.2, 16.8, 14.6, 14.2, 14.9, 14.7, 14.5, 15.2, 12.8, 16.0, 15.1, 16.4, 16.2, 15.8, 13.9, 13.1]
proteins["Shelly"]=[13.1, 14.5, 15.2, None, 12.4, 12.7, 13.7, 13.4, 13.7, 13.7, 11.4, 14.5, 13.7, 15.4, 14.6, 14.8, 13.1, 10.6]
proteins["Surpass"]=[13.0, 15.2, 15.4, 15.1, 12.7, 13.0, 14.4, 14.6, 15.0, 14.9, 11.9, 15.4, 15.6, 15.7, 15.8, 14.9, 12.6, 12.9]
proteins["SY Ingmar"]=[13.9, 16.0, 15.9, 16.7, 14.2, 13.6, 14.6, 14.6, 15.3, 14.8, 12.5, 14.9, 14.4, 15.3, 15.5, 13.6, 14.2, 13.1]
proteins["SY Rowyn"]=[12.9, 14.0, 15.4, 15.5, 13.2, 13.0, 13.7, 13.6, 13.8, 13.9, 11.5, 14.2, 13.8, 14.9, 15.0, 14.7, 12.8, 11.9]
proteins["SY Soren"]=[13.4, 16.0, 15.9, 16.3, 14.1, 14.2, 14.1, 15.0, 15.5, 15.0, 12.8, 15.2, 14.1, 14.3, 15.6, 14.4, 14.0, 11.6]
proteins["SY Valda"]=[13.1, 15.3, 14.6, 14.1, 12.8, 12.9, 13.8, 13.8, 14.7, 14.3, 12.0, 15.0, 14.3, 14.9, 14.3, 14.2, 12.7, 10.8]
proteins["TCG-Climax"]=[14.9, 16.6, 17.2, 15.5, 13.5, 14.5, 15.2, 15.6, 13.6, 15.9, 12.2, 17.5, 16.8, 17.0, 16.6, 16.0, 13.7, 11.7]
proteins["TCG-Cornerstone"]=[14.3, 15.1, 15.4, 15.1, 13.8, 12.8, 14.1, 14.5, 15.3, 14.6, 13.1, 14.3, 14.5, 15.8, 15.0, 15.7, 13.4, 12.9]
proteins["TCG-Spitfire"]=[13.0, 13.6, 15.1, 14.9, 12.7, 12.9, 13.9, 13.6, 14.1, 14.2, 12.0, 14.3, 14.0, 15.5, 14.5, 13.0, 13.3, 12.1]
proteins["WB-Mayville"]=[13.3, 16.1, 16.0, 15.5, 14.3, 13.7, 14.6, 14.7, 15.4, 14.8, 12.3, 15.1, 15.1, 14.9, 15.3, 14.8, 13.8, 13.0]
proteins["WB9479"]=[14.2, 16.7, 16.0, 16.2, 13.6, 13.4, 14.4, 14.7, 15.7, 15.0, 12.7, 16.1, 15.8, 15.3, 15.7, 15.1, 13.1, 11.4]
proteins["WB9590"]=[13.2, 15.3, 16.5, 15.8, 13.2, 13.8, 14.0, 14.1, 15.0, 15.1, 12.0, 15.5, 14.8, 15.0, 15.9, 16.1, 13.2, 12.7]
proteins["WB9653"]=[12.5, 14.0, 15.0, 14.7, 12.1, 11.9, 13.4, 13.5, 14.1, 13.9, 11.8, 14.4, 13.7, 15.1, 14.7, 14.0, 12.9, 11.4]


weights = {}
#weights["Bolles"] = [ 56.2, 61.3, 60.4, 56.8, 58.1, 56.0, 59.0, 59.2, 58.0, 60.0, 60.6, 58.5, 56.3, 58.6, 57.7, 59.5]
weights["Bolles"]=[60.5, 59.9, 59.7, 57.9, 60.7, 60.1, 59.7, 61.6, 62.3, 60.3, 61.9, 58.4, 60.8, 61.0, 59.5, 57.8, 60.4, 61.6]
weights["Boost"]=[59.4, 59.8, 59.7, 57.2, 60.0, 61.6, 59.8, 61.0, 61.4, 62.1, 62.5, 60.6, 60.9, 60.6, 60.0, 57.3, 59.2, 61.3]
weights["Chevelle"]=[60.7, 60.3, 60.8, 58.8, 59.9, 61.0, 60.2, 60.0, 62.4, 60.1, 61.3, 59.0, 60.8, 61.0, 60.7, 58.5, 61.1, 62.3]
weights["Dyna-Gro Ambush"]=[61.7, 60.6, 61.3, 59.2, 61.0, 62.2, 61.5, 62.3, 63.3, 62.6, 63.2, 61.3, 62.3, 62.2, 61.6, 59.6, 61.2, 62.9]
weights["Dyna-Gro Caliber"]=[61.3, 58.7, 60.1, 57.4, 59.2, 59.6, 59.5, 60.6, 61.0, 61.3, 62.3, 60.2, 60.0, 62.4, 60.3, 57.7, 59.8, 61.0]
weights["Faller"]=[60.4, 60.3, 60.0, 58.5, 60.8, 62.2, 59.9, 60.9, 62.8, 60.3, 61.4, 59.3, 60.3, 60.5, 60.4, 58.6, 60.7, 62.8]
weights["Forefront"]=[60.4, 60.2, 60.5, 58.4, 60.3, 61.0, 60.0, 61.4, 63.0, 63.2, 62.5, 59.5, 60.9, 62.0, 60.5, 58.6, 59.7, 62.1]
weights["HRS 3361"]=[58.7, 59.0, 59.8, 57.1, 60.5, 61.2, 59.9, 60.2, 59.9, 60.6, 62.0, 58.0, 60.4, 60.3, 61.0, 57.2, 59.0, 62.4]
weights["HRS 3419"]=[61.0, 59.0, 59.9, 57.6, 59.5, 62.2, 59.4, 59.9, 61.8, 60.0, 60.8, 60.6, 60.8, 59.0, 60.4, 57.3, 59.9, 62.1]
weights["HRS 3504"]=[60.1, 60.3, 59.9, 58.1, 59.8, 59.7, 59.7, 58.9, 60.5, 57.7, 61.3, 59.3, 59.8, 60.5, 60.4, 58.2, 59.4, 61.0]
weights["HRS 3530"]=[60.1, 60.3, 60.7, 58.7, 60.5, 61.3, 60.3, 60.8, 62.1, 61.2, 62.0, 59.1, 61.7, 60.7, 60.9, 58.6, 60.1, 62.9]
weights["HRS 3616"]=[60.2, 58.7, 59.7, 57.9, 60.6, 59.9, 60.5, 60.6, 62.0, 60.6, 61.7, 57.9, 60.7, 60.0, 59.3, 58.0, 59.7, 61.3]
weights["Lang-MN"]=[61.6, 60.1, 61.3, 59.8, 62.1, 62.3, 61.6, 62.4, 62.1, 61.6, 63.5, 60.0, 62.0, 63.0, 61.6, 59.7, 62.1, 63.4]
weights["LCS Albany"]=[60.0, 60.0, 60.1, 58.2, 61.4, 61.3, 60.6, 60.3, 61.0, 61.8, 61.4, 60.2, 60.9, 60.8, 60.9, 58.0, 61.6, 62.8]
weights["LCS Anchor"]=[61.6, 59.6, 60.3, 58.9, 60.1, 60.0, 60.6, 60.8, 62.5, 62.1, 62.8, 60.5, 60.5, 62.1, 60.7, 59.1, 60.8, 61.5]
weights["LCS Breakaway"]=[62.6, 62.0, 61.9, None, 60.7, 61.9, 62.0, 63.0, 62.4, 63.3, 64.1, 62.1, 62.0, 62.7, 62.4, 60.2, 60.3, 63.3]
weights["LCS Iguacu"]=[59.7, 60.9, 60.1, 57.9, 62.0, 62.4, 60.4, 61.6, 61.7, 62.1, 62.0, 60.9, 61.3, 62.1, 60.6, 57.4, 60.8, 63.8]
weights["LCS Nitro"]=[58.9, 59.7, 60.0, 58.0, 59.5, 60.7, 59.7, 59.4, 61.6, 58.6, 61.4, 60.5, 60.8, 60.7, 60.4, 58.1, 59.4, 61.9]
weights["LCS Prime"]=[61.4, 61.3, 61.5, 59.5, 60.7, 61.3, 60.7, 61.5, 61.3, 60.7, 61.6, 60.9, 61.5, 63.2, 61.8, 59.0, 61.1, 63.6]
weights["LCS Rebel"]=[62.3, 61.2, 61.4, 58.2, 61.0, 63.2, 61.3, 62.0, 60.6, 62.3, 63.7, 60.0, 61.7, 62.5, 61.1, 58.1, 61.7, 64.9]
weights["Linkert"]=[61.0, 60.4, 60.8, 59.0, 59.9, 60.4, 61.2, 61.4, 61.8, 60.5, 61.9, 60.5, 60.8, 62.7, 61.0, 59.0, 61.2, 61.4]
weights["ND-VitPro"]=[61.3, 61.1, 62.0, 60.2, 63.0, 62.1, 60.1, 62.2, 63.3, 63.6, 63.7, 61.5, 62.2, 63.2, 62.1, 60.5, 62.7, 63.5]
weights["Prevail"]=[60.3, 59.7, 60.3, 57.9, 58.7, 60.1, 60.4, 60.4, 61.9, 60.6, 61.4, 60.4, 60.4, 62.1, 60.3, 57.8, 58.3, 61.9]
weights["Prosper"]=[61.6, 60.4, 59.8, 58.6, 61.0, 61.9, 60.1, 61.0, 62.4, 61.5, 61.8, 59.9, 60.6, 61.7, 60.2, 58.7, 61.5, 63.1]
weights["RB07"]=[60.1, 59.6, 60.1, 58.2, 60.6, 59.5, 60.0, 60.7, 62.1, 61.8, 61.1, 58.5, 61.0, 61.5, 60.1, 58.1, 61.0, 62.0]
weights["Rollag"]=[61.6, 60.0, 60.8, 59.4, 61.0, 60.7, 61.4, 61.7, 62.8, 61.9, 63.0, 60.0, 61.8, 62.2, 61.1, 59.3, 61.5, 62.3]
weights["Shelly"]=[61.6, 60.0, 60.0, None, 61.3, 61.7, 60.2, 61.8, 62.9, 62.4, 62.6, 60.5, 61.9, 61.8, 60.5, 58.9, 61.0, 63.6]
weights["Surpass"]=[60.3, 60.2, 60.1, 57.9, 60.1, 59.9, 60.4, 61.0, 62.7, 61.1, 60.1, 60.5, 59.6, 61.4, 60.1, 58.0, 59.9, 61.0]
weights["SY Ingmar"]=[61.9, 61.3, 61.3, 58.8, 60.8, 61.2, 61.0, 61.6, 62.6, 59.7, 63.5, 60.5, 61.8, 62.7, 61.3, 58.1, 60.2, 63.3]
weights["SY Rowyn"]=[60.7, 60.4, 60.3, 58.9, 60.2, 60.6, 59.7, 61.0, 62.6, 60.6, 62.0, 60.9, 60.9, 60.3, 60.9, 60.2, 60.9, 62.1]
weights["SY Soren"]=[61.5, 60.2, 60.7, 59.6, 61.7, 60.9, 61.5, 61.1, 63.1, 62.1, 62.6, 59.2, 60.9, 62.4, 61.4, 59.7, 61.4, 62.8]
weights["SY Valda"]=[60.8, 60.3, 61.1, 58.1, 60.2, 61.9, 60.6, 61.2, 61.1, 61.1, 62.5, 57.0, 60.7, 60.8, 61.0, 58.5, 60.1, 62.9]
weights["TCG-Climax"]=[62.5, 61.0, 61.3, 59.9, 63.4, 62.0, 61.9, 64.3, 62.7, 63.2, 64.6, 61.5, 62.9, 63.1, 61.0, 60.0, 62.6, 64.7]
weights["TCG-Cornerstone"]=[60.3, 59.6, 60.4, 57.0, 59.2, 60.1, 60.2, 60.8, 62.2, 60.3, 62.3, 60.2, 61.6, 61.7, 60.1, 57.0, 59.0, 60.5]
weights["TCG-Spitfire"]=[61.4, 59.8, 60.8, 57.6, 60.0, 61.0, 60.1, 61.0, 61.2, 59.9, 61.5, 58.2, 60.0, 60.8, 60.2, 57.7, 58.8, 62.2]
weights["WB-Mayville"]=[61.2, 60.6, 61.7, 58.3, 59.5, 60.2, 61.5, 61.9, 62.6, 62.5, 62.4, 60.5, 61.6, 63.1, 61.6, 58.4, 60.0, 62.9]
weights["WB9479"]=[61.2, 60.3, 61.1, 58.3, 60.7, 61.2, 61.3, 62.2, 63.4, 62.4, 62.6, 61.2, 61.4, 61.5, 61.3, 58.3, 61.9, 62.6]
weights["WB9590"]=[60.6, 60.1, 61.2, 58.0, 60.6, 59.9, 60.9, 61.3, 61.0, 62.3, 62.1, 60.5, 61.3, 61.1, 61.3, 57.8, 59.1, 63.1]
weights["WB9653"]=[60.3, 60.3, 59.8, 57.9, 58.7, 60.5, 60.8, 59.9, 60.8, 58.5, 61.7, 60.3, 60.1, 60.1, 60.0, 57.8, 58.3, 62.2]


# insure consistency in sizing of arrays
for dic in (yields, weights, proteins):
  assert(len(dic.keys()) == len(varieties))
  for key in dic:
    assert(len(dic[key]) == len(locations))

planted = models.Date.objects.filter(date__year=2017, date__month=5)[0]
harvested = models.Date.objects.filter(date__year=2017, date__month=8)[0]

#normal = models.PlantingMethod.objects.filter(planting_methods="")[0]
normal = None

for vname in yields:
  for i in range(len(yield_lsds)):
    tags = None
    hidden = False
    bushels = yields[vname][i]
    if bushels is None:
      continue
    lname,  lsd5 = yield_lsds[i]
    if lname in rename_locations:
      lname, tags = rename_locations[lname]
    if tags is not None and tags is not "dryland":
      hidden = True
    weight = weights[vname][i]
    protein = proteins[vname][i]
    if vname in rename_varieties:
      dbvname = rename_varieties[vname]
    else:
      dbvname = vname
    if tags is not None:
      pass #tags = models.PlantingMethod.objects.filter(planting_methods=tags)[0]
    else:
      tags = normal
    new_trial = models.Trial_Entry.objects.filter(
        protein_percent=protein, 
        plant_date=planted, 
        harvest_date=harvested, 
        location=models.Location.objects.filter(name=lname)[0], 
        variety=models.Variety.objects.filter(name=dbvname)[0], 
        planting_method_tags=tags
      )
    try:
        assert(len(new_trial) == 1)
        new_trial = new_trial[0]
    except:
        print(lname, dbvname, bushels, planted, harvested)
        raise
    
    new_trial.bushels_acre = bushels
    new_trial.save()
    
