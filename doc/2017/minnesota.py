#$ python manage.py shell
from variety_trials_data import models

## source "17 WHIP.xlsx" sent 2017 Dec 7 12:22

locations = [
    "Saint Paul",
    "Waseca",
    "Lamberton",
    "Morris",
    "Crookston",
    "Roseau",
    "Fergus Falls",
    "Perley",
    "Oklee",
    "Stephen",
    "Hallock",
    "Benson",
    "Le Center",
    "Kimball",
    'Lamberton-i',
    'Morris-i',
    'Crookston-i',
    'Roseau-i'
  ]

rename_locations = {
    'Lamberton-i': ('Lamberton', 'intensive'),
    'Morris-i': ('Morris', 'intensive'),
    'Crookston-i': ('Crookston', 'intensive'),
    'Roseau-i': ('Roseau', 'intensive'),
  }

fail = False
for lname in locations:
  try:
    if lname in rename_locations:
      lname, tags = rename_locations[lname]
    location = models.Location.objects.filter(name=lname)[0]
  except:
    fail = True
    print 'Missing Location record: ', lname

varieties = [
    "Bolles",
    "Boost",
    "Chevelle",
    "Dyna-Gro Ambush",
    "Dyna-Gro Caliber",
    "Faller",
    "Forefront",
    "HRS 3361",
    "HRS 3419",
    "HRS 3504",
    "HRS 3530",
    "HRS 3616",
    "Lang-MN",
    "LCS Albany",
    "LCS Anchor",
    "LCS Breakaway",
    "LCS Iguacu",
    "LCS Nitro",
    "LCS Prime",
    "LCS Rebel",
    "Linkert",
    "ND-VitPro",
    "Prevail",
    "Prosper",
    "RB07",
    "Rollag",
    "Shelly",
    "Surpass",
    "SY Ingmar",
    "SY Rowyn",
    "SY Soren",
    "SY Valda",
    "TCG-Climax",
    "TCG-Cornerstone",
    "TCG-Spitfire",
    "WB-Mayville",
    "WB9479",
    "WB9590",
    "WB9653"
  ]

rename_varieties = {}
rename_varieties["Chevelle"] = "MS Chevelle"
rename_varieties["TCG-Cornerstone"] = "TCG Cornerstone"
rename_varieties["TCG-Spitfire"] = "TCG Spitfire"
rename_varieties["TCG-Climax"] = "TCG Climax"
rename_varieties["Dyna-Gro Ambush"] = "Ambush"
rename_varieties["Dyna-Gro Caliber"] = "Caliber"
rename_varieties["ND-VitPro"] = "ND VitPro"


for vname in varieties:
  try:
    if vname in rename_varieties:
      vname = rename_varieties[vname]
    variety = models.Variety.objects.filter(name=vname)[0]
  except:
    fail = True
    print 'Missing Variety record: ', vname
    models.Variety.objects.filter(name__contains=vname)

if fail:
  print ("ERROR: Missing records. See preceding output. Exiting...")
  import sys
  sys.exit(1)

# location name, yield lsd5
yield_lsds = [
    (   "Saint Paul", 10.75),
    (    "Waseca", 9.25),
    (    "Lamberton",9.42),
    (    "Morris",14.75),
    (    "Crookston",10.25),
    (    "Roseau",8.25),
    (    "Fergus Falls",6.75),
    (    "Perley",5.17),
    (    "Oklee",8.75),
    (    "Stephen",5.75),
    (    "Hallock",10.58),
    (    "Benson",12.5),
    (    "Le Center",9.5),
    (    "Kimball",11.17),
    (    'Lamberton-i',7.6),
    (    'Morris-i',9.9),
    (    'Crookston-i',11.5),
    (    'Roseau-i',9.8)
  ]

# regexps to help transform tab-delimited copy+paste from source workbook
# s/\t/, /
# s/$/]/
# s/^/yields["/
# s/^([^,]+), /\1"]=[/
yields = {}
#yields["Bolles"] = [ 103.5, 96.6, 101.3, 85.4, 70.7, 63.7, 73.0, 82.0, 81.8, 75.9, 82.9, 96.0, 62.6, 71.5, 67.2, 73.6]
yields["Bolles"] = [ 100.5, 95.6, 88.4, 100.7, 98.8, 101.0, 86.1, 101.6, 103.4, 98.4, 92.0, 77.7, 88.7, 101.5, 70.7, 64.5, 105.1, 115.3]
yields["Boost"] = [ 91.4, 99.2, 90.3, 91.9, 108.9, 103.4, 95.5, 96.7, 101.2, 96.6, 100.1, 86.2, 95.3, 103.0, 77.6, 64.3, 116.7, 111.1]
yields["Chevelle"] = [ 95.0, 106.9, 112.6, 111.6, 107.4, 99.2, 107.9, 109.3, 107.0, 107.8, 106.9, 82.1, 108.9, 96.5, 86.7, 73.5, 133.7, 111.4]
yields["Dyna-Gro Ambush"] = [ 96.0, 108.9, 99.6, 108.0, 98.4, 92.2, 94.1, 100.3, 103.9, 97.5, 103.1, 105.1, 101.0, 98.0, 81.1, 75.5, 100.0, 115.0]
yields["Dyna-Gro Caliber"] = [ 101.0, 78.0, 87.9, 86.6, 100.4, 88.6, 90.9, 87.4, 87.8, 92.7, 94.5, 100.7, 89.6, 94.5, 69.3, 57.0, 101.2, 98.1]
yields["Faller"] = [ 107.7, 86.8, 111.2, 97.2, 116.9, 112.6, 110.4, 111.9, 107.4, 107.3, 114.0, 105.5, 92.3, 97.8, 91.7, 76.7, 129.4, 129.1]
yields["Forefront"] = [ 112.5, 103.3, 88.9, 98.7, 96.7, 100.2, 81.8, 98.6, 101.8, 96.7, 90.2, 109.4, 98.5, 101.6, 78.7, 66.9, 97.2, 106.2]
yields["HRS 3361"] = [ 104.4, 103.4, 99.1, 101.6, 109.5, 96.3, 91.3, 97.8, 87.0, 99.9, 95.4, 97.4, 105.7, 98.9, 78.1, 66.5, 111.1, 112.1]
yields["HRS 3419"] = [ 104.4, 108.7, 95.9, 108.6, 110.7, 118.0, 105.8, 108.1, 121.0, 110.5, 98.8, 118.1, 112.0, 99.2, 82.8, 74.2, 129.9, 123.2]
yields["HRS 3504"] = [ 104.9, 115.1, 109.3, 116.2, 116.0, 110.3, 107.2, 105.0, 105.2, 101.2, 110.8, 113.8, 106.0, 94.3, 84.9, 73.5, 119.9, 124.1]
yields["HRS 3530"] = [ 101.4, 110.2, 106.3, 92.1, 104.5, 107.7, 104.9, 107.3, 93.4, 116.8, 104.4, 106.4, 116.0, 100.2, 92.8, 68.9, 106.4, 121.8]
yields["HRS 3616"] = [ 91.1, 90.6, 93.1, 95.4, 94.5, 97.8, 98.8, 99.6, 96.5, 96.6, 99.7, 78.5, 98.2, 102.8, 79.8, 67.7, 108.2, 98.3]
yields["Lang-MN"] = [ 105.8, 102.8, 102.8, 110.5, 94.3, 98.2, 96.3, 90.0, 95.5, 91.6, 105.1, 95.9, 89.4, 105.3, 83.8, 74.4, 100.5, 113.6]
yields["LCS Albany"] = [ 99.0, 91.7, 101.5, 101.2, 130.7, 112.3, 107.3, 102.5, 114.9, 105.3, 99.3, 103.2, 102.1, 107.9, 89.9, 77.0, 124.7, 125.5]
yields["LCS Anchor"] = [ 91.3, 84.0, 88.8, 84.2, 84.1, 72.0, 88.6, 90.9, 91.0, 91.6, 90.1, 87.9, 102.6, 96.4, 73.6, 61.3, 93.3, 95.5]
yields["LCS Breakaway"] = [ 96.8, 105.9, 98.9, 102.2, 83.1, 88.6, 109.2, 102.3, 95.8, 93.6, 98.0, 101.5, 92.1, 103.3, 81.0, 72.7, 90.9, 104.4]
yields["LCS Iguacu"] = [ 84.5, 92.5, 96.6, 103.5, 119.1, 107.3, 92.6, 103.5, 113.7, 106.7, 102.6, 99.4, 106.9, 99.4, 75.0, 69.6, 120.9, 119.5]
yields["LCS Nitro"] = [ 88.3, 103.5, 94.0, 117.1, 107.5, 105.6, 96.3, 107.6, 95.9, 102.7, 98.8, 102.5, 106.8, 98.9, 76.2, 79.4, 118.3, 116.8]
yields["LCS Prime"] = [ 97.8, 101.1, 115.6, 110.3, 87.5, 107.5, 115.0, 112.1, 113.9, 101.5, 114.6, 114.1, 110.2, 98.5, 92.6, 74.6, 107.8, 127.7]
yields["LCS Rebel"] = [ 99.8, 90.8, 100.1, 95.6, 105.1, 98.9, 97.2, 95.3, 103.5, 98.9, 105.8, 92.9, 92.0, 94.8, 82.5, 68.0, 113.9, 119.7]
yields["Linkert"] = [ 107.1, 97.3, 100.4, 99.5, 95.3, 94.7, 93.7, 96.1, 94.0, 88.2, 101.7, 98.8, 99.2, 93.3, 78.0, 68.4, 106.9, 102.1]
yields["ND-VitPro"] = [ 100.7, 95.6, 89.1, 82.6, 91.0, 92.9, 85.5, 92.5, 86.3, 89.5, 96.5, 86.2, 85.4, 101.2, 69.8, 61.3, 89.9, 104.4]
yields["Prevail"] = [ 98.8, 99.9, 90.3, 89.5, 88.1, 98.7, 98.2, 93.6, 100.2, 95.4, 101.5, 104.4, 100.9, 106.2, 78.1, 66.1, 93.0, 105.6]
yields["Prosper"] = [ 107.3, 94.8, 110.2, 91.6, 112.3, 110.8, 107.6, 108.1, 110.3, 110.0, 115.2, 114.0, 104.3, 107.4, 95.1, 72.8, 136.5, 129.2]
yields["RB07"] = [ 89.7, 98.2, 90.6, 94.3, 101.5, 88.8, 106.5, 100.6, 92.9, 107.1, 101.4, 86.9, 97.4, 100.0, 79.6, 53.9, 116.7, 107.7]
yields["Rollag"] = [ 92.9, 89.9, 95.5, 92.0, 95.6, 87.2, 95.9, 96.9, 95.5, 97.7, 94.2, 98.2, 100.5, 97.5, 77.2, 57.0, 100.9, 98.0]
yields["Shelly"] = [ 107.8, 103.9, 109.2, 109.3, 109.4, 109.7, 117.5, 108.3, 104.5, 112.3, 102.7, 93.9, 105.7, 106.1, 89.1, 76.8, 116.8, 121.7]
yields["Surpass"] = [ 108.3, 112.9, 101.2, 91.9, 96.4, 100.5, 102.3, 99.9, 98.5, 101.7, 109.1, 108.3, 89.7, 107.7, 77.2, 63.0, 108.7, 112.2]
yields["SY Ingmar"] = [ 94.2, 100.5, 99.7, 88.3, 89.3, 89.0, 96.5, 96.6, 103.4, 96.9, 94.7, 95.9, 104.5, 89.6, 84.8, 60.8, 91.4, 98.9]
yields["SY Rowyn"] = [ 94.4, 95.3, 93.9, 104.4, 105.0, 103.2, 107.6, 108.6, 111.5, 104.3, 100.0, 108.7, 97.0, 95.6, 79.9, 68.9, 116.4, 110.4]
yields["SY Soren"] = [ 98.5, 93.3, 98.6, 97.7, 102.5, 97.0, 97.0, 92.6, 95.9, 97.7, 98.9, 86.6, 105.1, 109.8, 82.7, 57.7, 110.3, 106.1]
yields["SY Valda"] = [ 102.0, 111.7, 114.2, 107.1, 117.2, 105.2, 115.0, 108.5, 116.1, 112.7, 110.2, 117.3, 119.1, 99.6, 96.3, 71.1, 122.1, 120.7]
yields["TCG-Climax"] = [ 91.4, 94.0, 98.3, 110.0, 108.1, 96.1, 95.9, 88.6, 107.6, 94.7, 86.8, 90.5, 81.4, 95.4, 78.8, 69.3, 121.2, 106.0]
yields["TCG-Cornerstone"] = [ 99.4, 91.3, 101.9, 101.5, 87.7, 89.0, 98.4, 92.8, 85.1, 88.6, 89.0, 97.0, 102.3, 95.9, 83.0, 63.7, 99.8, 99.2]
yields["TCG-Spitfire"] = [ 110.4, 101.1, 116.6, 109.6, 103.5, 102.0, 110.7, 102.3, 114.4, 103.5, 98.2, 101.1, 109.6, 101.5, 93.8, 68.4, 98.7, 122.8]
yields["WB-Mayville"] = [ 98.5, 95.6, 102.6, 110.4, 84.5, 90.9, 97.3, 95.0, 91.7, 99.6, 96.5, 119.7, 105.6, 108.2, 86.4, 66.6, 105.3, 102.8]
yields["WB9479"] = [ 98.5, 101.6, 97.1, 108.0, 103.4, 95.2, 92.2, 98.5, 102.1, 104.9, 92.9, 110.1, 92.6, 102.3, 80.5, 69.6, 113.9, 113.2]
yields["WB9590"] = [ 96.0, 107.2, 97.2, 114.1, 101.3, 87.8, 101.9, 103.1, 98.5, 112.8, 100.8, 119.0, 92.6, 102.9, 83.8, 74.8, 102.8, 125.0]
yields["WB9653"] = [ 108.7, 119.4, 108.7, 99.8, 101.4, 112.3, 107.5, 103.1, 101.6, 101.2, 113.8, 110.5, 110.1, 97.4, 84.9, 75.4, 110.0, 122.7]


proteins = {}
#proteins["Bolles"] = [ 14.8, 14.0, 15.4, 17.1, 16.7, 17.5, 16.9, 16.2, 17.2, 16.2, 16.0, 15.1, 17.0, 15.9, 14.2, 15.2]
proteins["Bolles"]=[14.0, 16.2, 16.2, 17.1, 13.2, 14.3, 14.8, 15.8, 16.3, 16.2, 11.6, 17.4, 16.0, 17.6, 17.7, 18.2, 13.9, 12.6]
proteins["Boost"]=[14.6, 15.8, 16.0, 16.7, 13.1, 13.5, 14.8, 13.9, 15.3, 14.6, 12.2, 15.3, 14.9, 16.6, 16.0, 15.8, 13.1, 11.9]
proteins["Chevelle"]=[11.9, 13.9, 14.5, 15.4, 12.2, 11.5, 13.0, 13.2, 13.8, 13.6, 10.3, 14.7, 13.6, 14.5, 14.4, 13.4, 12.6, 12.3]
proteins["Dyna-Gro Ambush"]=[13.0, 14.9, 16.0, 15.5, 14.4, 13.4, 14.6, 14.6, 15.0, 15.1, 12.2, 15.4, 14.5, 15.7, 15.7, 14.8, 13.9, 13.0]
proteins["Dyna-Gro Caliber"]=[14.5, 16.4, 14.5, 15.8, 14.6, 14.2, 15.0, 15.0, 15.4, 14.8, 13.6, 15.4, 15.2, 15.7, 16.3, 16.5, 14.1, 12.5]
proteins["Faller"]=[12.6, 13.1, 14.2, 13.7, 11.7, 11.9, 13.9, 13.0, 13.1, 13.9, 10.9, 15.0, 13.2, 14.8, 15.1, 13.9, 11.6, 10.5]
proteins["Forefront"]=[13.4, 15.7, 15.7, 16.6, 13.6, 13.9, 14.2, 14.0, 14.2, 14.9, 12.2, 14.9, 14.4, 14.8, 15.7, 15.4, 13.4, 12.1]
proteins["HRS 3361"]=[13.4, 15.3, 14.4, 15.6, 13.0, 13.1, 13.5, 13.7, 15.0, 14.4, 12.7, 15.3, 14.0, 15.4, 15.1, 13.8, 13.0, 12.7]
proteins["HRS 3419"]=[14.0, 13.5, 15.0, 14.2, 11.9, 11.6, 12.6, 12.9, 12.8, 14.3, 10.9, 14.3, 12.9, 15.5, 14.1, 13.1, 10.8, 10.4]
proteins["HRS 3504"]=[12.7, 14.4, 14.5, 15.2, 12.5, 12.8, 13.0, 13.5, 13.3, 14.0, 11.6, 14.5, 14.4, 15.6, 14.6, 14.6, 12.1, 11.4]
proteins["HRS 3530"]=[13.2, 14.8, 16.4, 16.5, 12.7, 12.2, 14.4, 13.9, 14.1, 14.6, 11.1, 15.6, 15.3, 15.4, 16.9, 15.9, 12.8, 11.1]
proteins["HRS 3616"]=[13.9, 16.2, 16.2, 17.0, 14.0, 14.4, 14.6, 14.7, 15.0, 15.2, 13.3, 15.8, 15.4, 16.0, 16.6, 17.1, 14.3, 13.0]
proteins["Lang-MN"]=[14.3, 15.6, 15.8, 15.7, 13.2, 13.6, 13.9, 14.8, 14.4, 15.4, 13.2, 15.2, 15.3, 15.6, 15.8, 16.0, 13.8, 12.2]
proteins["LCS Albany"]=[13.2, 13.8, 14.5, 15.4, 11.3, 11.7, 13.4, 12.9, 13.5, 13.6, 11.0, 13.9, 14.3, 14.9, 14.3, 14.2, 11.5, 10.8]
proteins["LCS Anchor"]=[14.9, 16.4, 15.9, 16.1, 14.0, 14.5, 14.1, 14.7, 15.6, 14.9, 12.9, 15.0, 14.7, 15.2, 16.4, 15.5, 13.2, 13.7]
proteins["LCS Breakaway"]=[13.2, 15.8, 15.9, None, 13.8, 13.5, 14.4, 14.3, 14.7, 14.5, 11.8, 14.5, 15.2, 15.7, 15.9, 15.8, 13.3, 12.6]
proteins["LCS Iguacu"]=[14.3, 13.6, 14.7, 14.2, 11.5, 11.3, 13.3, 12.5, 13.0, 12.7, 11.7, 13.4, 13.0, 14.0, 14.7, 14.4, 12.1, 11.4]
proteins["LCS Nitro"]=[13.2, 14.1, 14.3, 14.4, 12.1, 11.8, 12.9, 12.9, 13.2, 13.5, 10.8, 13.9, 13.3, 14.6, 14.6, 13.6, 12.5, 10.2]
proteins["LCS Prime"]=[12.2, 13.7, 14.2, 13.2, 12.6, 12.1, 13.2, 12.9, 13.3, 14.0, 11.4, 14.3, 13.1, 14.1, 14.3, 12.1, 12.3, 11.7]
proteins["LCS Rebel"]=[14.1, 15.4, 15.6, 15.1, 13.3, 13.3, 13.7, 14.2, 14.4, 14.9, 11.5, 15.5, 14.8, 14.9, 16.3, 15.9, 13.6, 11.6]
proteins["Linkert"]=[14.1, 15.8, 16.1, 16.6, 14.6, 15.0, 15.0, 15.2, 16.6, 15.6, 12.8, 15.8, 15.2, 16.6, 16.4, 16.0, 13.7, 13.6]
proteins["ND-VitPro"]=[13.6, 15.8, 15.8, 16.2, 14.2, 13.9, 14.3, 15.3, 15.8, 15.4, 13.4, 15.4, 15.9, 15.6, 15.0, 15.4, 13.7, 12.8]
proteins["Prevail"]=[12.6, 15.2, 15.4, 15.8, 13.2, 12.7, 13.6, 13.8, 14.7, 13.9, 12.2, 14.1, 14.2, 14.4, 15.4, 14.2, 13.5, 12.3]
proteins["Prosper"]=[12.9, 13.5, 14.7, 13.4, 12.0, 11.3, 13.8, 12.8, 13.1, 13.8, 11.5, 14.5, 12.8, 13.7, 15.0, 13.6, 12.3, 10.8]
proteins["RB07"]=[13.6, 16.3, 16.1, 14.8, 13.6, 13.5, 14.1, 13.9, 14.7, 14.4, 12.3, 15.8, 14.3, 15.3, 15.9, 14.5, 13.2, 12.1]
proteins["Rollag"]=[14.0, 16.5, 16.2, 16.8, 14.6, 14.2, 14.9, 14.7, 14.5, 15.2, 12.8, 16.0, 15.1, 16.4, 16.2, 15.8, 13.9, 13.1]
proteins["Shelly"]=[13.1, 14.5, 15.2, None, 12.4, 12.7, 13.7, 13.4, 13.7, 13.7, 11.4, 14.5, 13.7, 15.4, 14.6, 14.8, 13.1, 10.6]
proteins["Surpass"]=[13.0, 15.2, 15.4, 15.1, 12.7, 13.0, 14.4, 14.6, 15.0, 14.9, 11.9, 15.4, 15.6, 15.7, 15.8, 14.9, 12.6, 12.9]
proteins["SY Ingmar"]=[13.9, 16.0, 15.9, 16.7, 14.2, 13.6, 14.6, 14.6, 15.3, 14.8, 12.5, 14.9, 14.4, 15.3, 15.5, 13.6, 14.2, 13.1]
proteins["SY Rowyn"]=[12.9, 14.0, 15.4, 15.5, 13.2, 13.0, 13.7, 13.6, 13.8, 13.9, 11.5, 14.2, 13.8, 14.9, 15.0, 14.7, 12.8, 11.9]
proteins["SY Soren"]=[13.4, 16.0, 15.9, 16.3, 14.1, 14.2, 14.1, 15.0, 15.5, 15.0, 12.8, 15.2, 14.1, 14.3, 15.6, 14.4, 14.0, 11.6]
proteins["SY Valda"]=[13.1, 15.3, 14.6, 14.1, 12.8, 12.9, 13.8, 13.8, 14.7, 14.3, 12.0, 15.0, 14.3, 14.9, 14.3, 14.2, 12.7, 10.8]
proteins["TCG-Climax"]=[14.9, 16.6, 17.2, 15.5, 13.5, 14.5, 15.2, 15.6, 13.6, 15.9, 12.2, 17.5, 16.8, 17.0, 16.6, 16.0, 13.7, 11.7]
proteins["TCG-Cornerstone"]=[14.3, 15.1, 15.4, 15.1, 13.8, 12.8, 14.1, 14.5, 15.3, 14.6, 13.1, 14.3, 14.5, 15.8, 15.0, 15.7, 13.4, 12.9]
proteins["TCG-Spitfire"]=[13.0, 13.6, 15.1, 14.9, 12.7, 12.9, 13.9, 13.6, 14.1, 14.2, 12.0, 14.3, 14.0, 15.5, 14.5, 13.0, 13.3, 12.1]
proteins["WB-Mayville"]=[13.3, 16.1, 16.0, 15.5, 14.3, 13.7, 14.6, 14.7, 15.4, 14.8, 12.3, 15.1, 15.1, 14.9, 15.3, 14.8, 13.8, 13.0]
proteins["WB9479"]=[14.2, 16.7, 16.0, 16.2, 13.6, 13.4, 14.4, 14.7, 15.7, 15.0, 12.7, 16.1, 15.8, 15.3, 15.7, 15.1, 13.1, 11.4]
proteins["WB9590"]=[13.2, 15.3, 16.5, 15.8, 13.2, 13.8, 14.0, 14.1, 15.0, 15.1, 12.0, 15.5, 14.8, 15.0, 15.9, 16.1, 13.2, 12.7]
proteins["WB9653"]=[12.5, 14.0, 15.0, 14.7, 12.1, 11.9, 13.4, 13.5, 14.1, 13.9, 11.8, 14.4, 13.7, 15.1, 14.7, 14.0, 12.9, 11.4]


weights = {}
#weights["Bolles"] = [ 56.2, 61.3, 60.4, 56.8, 58.1, 56.0, 59.0, 59.2, 58.0, 60.0, 60.6, 58.5, 56.3, 58.6, 57.7, 59.5]
weights["Bolles"]=[60.5, 59.9, 59.7, 57.9, 60.7, 60.1, 59.7, 61.6, 62.3, 60.3, 61.9, 58.4, 60.8, 61.0, 59.5, 57.8, 60.4, 61.6]
weights["Boost"]=[59.4, 59.8, 59.7, 57.2, 60.0, 61.6, 59.8, 61.0, 61.4, 62.1, 62.5, 60.6, 60.9, 60.6, 60.0, 57.3, 59.2, 61.3]
weights["Chevelle"]=[60.7, 60.3, 60.8, 58.8, 59.9, 61.0, 60.2, 60.0, 62.4, 60.1, 61.3, 59.0, 60.8, 61.0, 60.7, 58.5, 61.1, 62.3]
weights["Dyna-Gro Ambush"]=[61.7, 60.6, 61.3, 59.2, 61.0, 62.2, 61.5, 62.3, 63.3, 62.6, 63.2, 61.3, 62.3, 62.2, 61.6, 59.6, 61.2, 62.9]
weights["Dyna-Gro Caliber"]=[61.3, 58.7, 60.1, 57.4, 59.2, 59.6, 59.5, 60.6, 61.0, 61.3, 62.3, 60.2, 60.0, 62.4, 60.3, 57.7, 59.8, 61.0]
weights["Faller"]=[60.4, 60.3, 60.0, 58.5, 60.8, 62.2, 59.9, 60.9, 62.8, 60.3, 61.4, 59.3, 60.3, 60.5, 60.4, 58.6, 60.7, 62.8]
weights["Forefront"]=[60.4, 60.2, 60.5, 58.4, 60.3, 61.0, 60.0, 61.4, 63.0, 63.2, 62.5, 59.5, 60.9, 62.0, 60.5, 58.6, 59.7, 62.1]
weights["HRS 3361"]=[58.7, 59.0, 59.8, 57.1, 60.5, 61.2, 59.9, 60.2, 59.9, 60.6, 62.0, 58.0, 60.4, 60.3, 61.0, 57.2, 59.0, 62.4]
weights["HRS 3419"]=[61.0, 59.0, 59.9, 57.6, 59.5, 62.2, 59.4, 59.9, 61.8, 60.0, 60.8, 60.6, 60.8, 59.0, 60.4, 57.3, 59.9, 62.1]
weights["HRS 3504"]=[60.1, 60.3, 59.9, 58.1, 59.8, 59.7, 59.7, 58.9, 60.5, 57.7, 61.3, 59.3, 59.8, 60.5, 60.4, 58.2, 59.4, 61.0]
weights["HRS 3530"]=[60.1, 60.3, 60.7, 58.7, 60.5, 61.3, 60.3, 60.8, 62.1, 61.2, 62.0, 59.1, 61.7, 60.7, 60.9, 58.6, 60.1, 62.9]
weights["HRS 3616"]=[60.2, 58.7, 59.7, 57.9, 60.6, 59.9, 60.5, 60.6, 62.0, 60.6, 61.7, 57.9, 60.7, 60.0, 59.3, 58.0, 59.7, 61.3]
weights["Lang-MN"]=[61.6, 60.1, 61.3, 59.8, 62.1, 62.3, 61.6, 62.4, 62.1, 61.6, 63.5, 60.0, 62.0, 63.0, 61.6, 59.7, 62.1, 63.4]
weights["LCS Albany"]=[60.0, 60.0, 60.1, 58.2, 61.4, 61.3, 60.6, 60.3, 61.0, 61.8, 61.4, 60.2, 60.9, 60.8, 60.9, 58.0, 61.6, 62.8]
weights["LCS Anchor"]=[61.6, 59.6, 60.3, 58.9, 60.1, 60.0, 60.6, 60.8, 62.5, 62.1, 62.8, 60.5, 60.5, 62.1, 60.7, 59.1, 60.8, 61.5]
weights["LCS Breakaway"]=[62.6, 62.0, 61.9, None, 60.7, 61.9, 62.0, 63.0, 62.4, 63.3, 64.1, 62.1, 62.0, 62.7, 62.4, 60.2, 60.3, 63.3]
weights["LCS Iguacu"]=[59.7, 60.9, 60.1, 57.9, 62.0, 62.4, 60.4, 61.6, 61.7, 62.1, 62.0, 60.9, 61.3, 62.1, 60.6, 57.4, 60.8, 63.8]
weights["LCS Nitro"]=[58.9, 59.7, 60.0, 58.0, 59.5, 60.7, 59.7, 59.4, 61.6, 58.6, 61.4, 60.5, 60.8, 60.7, 60.4, 58.1, 59.4, 61.9]
weights["LCS Prime"]=[61.4, 61.3, 61.5, 59.5, 60.7, 61.3, 60.7, 61.5, 61.3, 60.7, 61.6, 60.9, 61.5, 63.2, 61.8, 59.0, 61.1, 63.6]
weights["LCS Rebel"]=[62.3, 61.2, 61.4, 58.2, 61.0, 63.2, 61.3, 62.0, 60.6, 62.3, 63.7, 60.0, 61.7, 62.5, 61.1, 58.1, 61.7, 64.9]
weights["Linkert"]=[61.0, 60.4, 60.8, 59.0, 59.9, 60.4, 61.2, 61.4, 61.8, 60.5, 61.9, 60.5, 60.8, 62.7, 61.0, 59.0, 61.2, 61.4]
weights["ND-VitPro"]=[61.3, 61.1, 62.0, 60.2, 63.0, 62.1, 60.1, 62.2, 63.3, 63.6, 63.7, 61.5, 62.2, 63.2, 62.1, 60.5, 62.7, 63.5]
weights["Prevail"]=[60.3, 59.7, 60.3, 57.9, 58.7, 60.1, 60.4, 60.4, 61.9, 60.6, 61.4, 60.4, 60.4, 62.1, 60.3, 57.8, 58.3, 61.9]
weights["Prosper"]=[61.6, 60.4, 59.8, 58.6, 61.0, 61.9, 60.1, 61.0, 62.4, 61.5, 61.8, 59.9, 60.6, 61.7, 60.2, 58.7, 61.5, 63.1]
weights["RB07"]=[60.1, 59.6, 60.1, 58.2, 60.6, 59.5, 60.0, 60.7, 62.1, 61.8, 61.1, 58.5, 61.0, 61.5, 60.1, 58.1, 61.0, 62.0]
weights["Rollag"]=[61.6, 60.0, 60.8, 59.4, 61.0, 60.7, 61.4, 61.7, 62.8, 61.9, 63.0, 60.0, 61.8, 62.2, 61.1, 59.3, 61.5, 62.3]
weights["Shelly"]=[61.6, 60.0, 60.0, None, 61.3, 61.7, 60.2, 61.8, 62.9, 62.4, 62.6, 60.5, 61.9, 61.8, 60.5, 58.9, 61.0, 63.6]
weights["Surpass"]=[60.3, 60.2, 60.1, 57.9, 60.1, 59.9, 60.4, 61.0, 62.7, 61.1, 60.1, 60.5, 59.6, 61.4, 60.1, 58.0, 59.9, 61.0]
weights["SY Ingmar"]=[61.9, 61.3, 61.3, 58.8, 60.8, 61.2, 61.0, 61.6, 62.6, 59.7, 63.5, 60.5, 61.8, 62.7, 61.3, 58.1, 60.2, 63.3]
weights["SY Rowyn"]=[60.7, 60.4, 60.3, 58.9, 60.2, 60.6, 59.7, 61.0, 62.6, 60.6, 62.0, 60.9, 60.9, 60.3, 60.9, 60.2, 60.9, 62.1]
weights["SY Soren"]=[61.5, 60.2, 60.7, 59.6, 61.7, 60.9, 61.5, 61.1, 63.1, 62.1, 62.6, 59.2, 60.9, 62.4, 61.4, 59.7, 61.4, 62.8]
weights["SY Valda"]=[60.8, 60.3, 61.1, 58.1, 60.2, 61.9, 60.6, 61.2, 61.1, 61.1, 62.5, 57.0, 60.7, 60.8, 61.0, 58.5, 60.1, 62.9]
weights["TCG-Climax"]=[62.5, 61.0, 61.3, 59.9, 63.4, 62.0, 61.9, 64.3, 62.7, 63.2, 64.6, 61.5, 62.9, 63.1, 61.0, 60.0, 62.6, 64.7]
weights["TCG-Cornerstone"]=[60.3, 59.6, 60.4, 57.0, 59.2, 60.1, 60.2, 60.8, 62.2, 60.3, 62.3, 60.2, 61.6, 61.7, 60.1, 57.0, 59.0, 60.5]
weights["TCG-Spitfire"]=[61.4, 59.8, 60.8, 57.6, 60.0, 61.0, 60.1, 61.0, 61.2, 59.9, 61.5, 58.2, 60.0, 60.8, 60.2, 57.7, 58.8, 62.2]
weights["WB-Mayville"]=[61.2, 60.6, 61.7, 58.3, 59.5, 60.2, 61.5, 61.9, 62.6, 62.5, 62.4, 60.5, 61.6, 63.1, 61.6, 58.4, 60.0, 62.9]
weights["WB9479"]=[61.2, 60.3, 61.1, 58.3, 60.7, 61.2, 61.3, 62.2, 63.4, 62.4, 62.6, 61.2, 61.4, 61.5, 61.3, 58.3, 61.9, 62.6]
weights["WB9590"]=[60.6, 60.1, 61.2, 58.0, 60.6, 59.9, 60.9, 61.3, 61.0, 62.3, 62.1, 60.5, 61.3, 61.1, 61.3, 57.8, 59.1, 63.1]
weights["WB9653"]=[60.3, 60.3, 59.8, 57.9, 58.7, 60.5, 60.8, 59.9, 60.8, 58.5, 61.7, 60.3, 60.1, 60.1, 60.0, 57.8, 58.3, 62.2]


# insure consistency in sizing of arrays
for dic in (yields, weights, proteins):
  assert(len(dic.keys()) == len(varieties))
  for key in dic:
    assert(len(dic[key]) == len(locations))

planted = models.Date.objects.filter(date__year=2017, date__month=5)[0]
harvested = models.Date.objects.filter(date__year=2017, date__month=8)[0]

normal = models.PlantingMethod.objects.filter(planting_methods="")[0]

for vname in yields:
  for i in range(len(yield_lsds)):
    tags = None
    hidden = False
    bushels = yields[vname][i]
    if bushels is None:
      continue
    lname,  lsd5 = yield_lsds[i]
    if lname in rename_locations:
      lname, tags = rename_locations[lname]
    if tags is not None and tags is not "dryland":
      hidden = True
    weight = weights[vname][i]
    protein = proteins[vname][i]
    if vname in rename_varieties:
      dbvname = rename_varieties[vname]
    else:
      dbvname = vname
    new_trial = models.TrialEntry(
        bushels_acre=bushels, 
        plant_date=planted, 
        harvest_date=harvested, 
        location=models.Location.objects.filter(name=lname)[0], 
        variety=models.Variety.objects.filter(name=dbvname)[0], 
        hidden=hidden
      )
    if weight is not None:
      new_trial.test_weight = weight
    if protein is not None:
      new_trial.protein_percent = protein
    if tags is not None:
      new_trial.planting_method_tags = models.PlantingMethod.objects.filter(planting_methods=tags)[0]
    else:
      new_trial.planting_method_tags = normal
    if lsd5 is not None: 
      new_trial.lsd_05 = lsd5
    new_trial.save()
    
